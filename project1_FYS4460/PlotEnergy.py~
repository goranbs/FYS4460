'''
PlotEnergy.py - project1_FYS4460

Should read output files, sum up the total energy of the system, and plot
the energy as a function of time to see how well the energy of the system 
is conserved.
'''

import numpy as np
import os, sys

num_files = 199

filename = 'state%03g.txt' % 0      # filename = 'state000.txt' initial file
file = open(filename,'r')

N = int(file.readline())            # number of atoms
secondline = file.readline()
somestring,t0 = secondline.split()
t0 = float(t0)                        # time in simulation
E_sys = []
E_sys.append(0) # first value
for i in range(num_files-1):
    i = i+1
    filename = 'state%03g.txt' % i      # filename = 'state000.txt'
    file = open(filename,'r')
    
    N_atoms = int(file.readline())            # number of atoms
    secondline = file.readline()
    somestring,t = secondline.split()
    t = float(t)                        # time in simulation
    
    E_tot = []
    j = 0
    for line_j in file:
        line = line_j.split()           # split line on whitespace
        E_tot.append(float(line[10]))
        j += 1
        
    if j == N_atoms:
        print '%g OK' % i
    else:
        print 'Danger!! j != N'

    E_system = 0
    for element in range(N_atoms):
        E_system += E_tot[element]

    E_sys.append(E_system)

##################################################
# plotting

import matplotlib.pyplot as plt

figure()
plt.plot(t,E_sys)
plt.title('Energy of system')
plt.xlabel('unitless time')
plt.ylabel('unitless energy')
plt.legend('E(t)')
plt.show(True)
